"use strict";(()=>{var O=Object.defineProperty;var o=(e,t)=>O(e,"name",{value:t,configurable:!0});function r(e){parent==null||parent.postMessage(e,"https://replit.com"),parent==null||parent.postMessage(e,"https://staging.replit.com"),parent==null||parent.postMessage(e,"https://firewalledreplit.com/"),parent==null||parent.postMessage(e,"https://staging.firewalledreplit.com/"),parent==null||parent.postMessage(e,"http://localhost:3000")}o(r,"postMessageToWorkspace");var k=document.getElementById("iframe");function l(){try{return k.contentWindow.document.body,!0}catch{return!1}}o(l,"canAccessIframeWindow");var f="/devtools/devtools.js";var T="/devtools/devtools-react.js";function x(e){return`/__replco/static/${e.replace(/^\/+/,"")}`}o(x,"getStaticPath");function d(e){let t=document.createElement("script");return t.async=!1,t.src=x(e),t}o(d,"createScript");var v="__replit_devtools__",g=document.getElementById("iframe");function u(e){function t(){if(!l()){r({type:"page-navigation",payload:{isExternal:!0}});return}r({type:"page-navigation",payload:{isExternal:!1,path:new URL(e).pathname}});let i=g.contentWindow.document;if(i.getElementById(v))return;let s=d(f);s.id=v,i.head.appendChild(s)}o(t,"onload"),g.addEventListener("load",t),g.src=e}o(u,"fallbackLoad");var a=document.getElementById("iframe");async function M(e){let i=a.contentWindow.location.href;for(let n=0;n<10&&(await new Promise(c=>setTimeout(c,0)),!(!l()||i!==a.contentWindow.location.href));n++);if(!l()){r({type:"page-navigation",payload:{isExternal:!0}});return}a.contentWindow.stop();let s;try{s=a.contentWindow.location.href}catch{r({type:"page-load-error"});return}try{a.setAttribute("srcdoc","<!DOCTYPE html><html><body></body></html>"),h(s)}catch{r({type:"page-load-error"})}}o(M,"unloadHandler");async function h(e){var S;let t=new URL(e,window.location.origin);if(t.origin!==window.location.origin){u(e);return}let i=t.pathname+t.search+t.hash,s=t.href,n=await fetch(s,{method:"GET",credentials:"same-origin"});if(!n.ok)if(n.status===404)r({type:"page-load-error",payload:{statusCode:n.status}});else throw new Error(`fetch-error: ${n.status} ${n.statusText}`);let c=await n.text(),p=new DOMParser().parseFromString(c,"text/html"),y=document.createElement("script");y.innerHTML=`history.pushState(null, null, ${JSON.stringify(i)});`;let w=p.createElement("base");w.href=s,p.head.prepend(w);let b=d(f),E=[y,b];(c.includes("import RefreshRuntime from")||c.includes('<div id="__next"')||c.includes('<meta name="replit:template" content="react" />'))&&E.unshift(d(T)),p.head.prepend(...E);let m=a.contentDocument;m.open(),((S=p.doctype)==null?void 0:S.name)==="html"&&m.write("<!DOCTYPE html>"),m.write(p.documentElement.outerHTML),m.close(),r({type:"page-navigation",payload:{isExternal:!1,path:t.pathname,relativeUrl:i}});function L(){a.contentWindow.removeEventListener("unload",M),a.contentWindow.addEventListener("unload",M)}o(L,"attachUnload"),a.addEventListener("load",L),L()}o(h,"fetchLoad");async function W(e){try{await h(e);return}catch(t){console.log("error fetchLoad failed"),console.error(t)}try{u(e)}catch{r({type:"page-load-error"})}}o(W,"tryLoad");var D=new URLSearchParams(window.location.search),_,I=(_=D.get("initialPath"))!=null?_:"/";W(I);window.addEventListener("message",e=>{e.origin===location.origin?r(e.data):document.getElementById("iframe").contentWindow.postMessage(e.data,location.origin)});})();
